# Risk Register (Go GoClaw vs Rust Reference Findings)

Scales:
- Likelihood: Low / Medium / High
- Impact: Medium / High / Critical

| ID | Risk | Likelihood | Impact | Evidence | Mitigation (SPEC/PDR change) | Detection / test |
|---|---|---|---|---|---|---|
| R-01 | Queue correctness regression if implementation drifts from lease-based model to in-memory scheduling patterns. | Medium | Critical | Contract requires lease claims (SPEC ยง5.4: "Task claim MUST be atomic and lease-based"). Rust uses in-memory scheduler map (`/Users/basket/workspace/go-claw/reference/goclaw/src/agent/scheduler.rs:45-56`). | Add explicit lease-token completion guard and stale completion rejection in SPEC ยง5.4/ยง9. | 100-way concurrent claim/complete chaos test with forced worker pauses and reclaim races. |
| R-02 | Duplicate or missing side-effects around crashes due detached persistence writes. | High | Critical | Rust fire-and-forget status/action/event persistence (`/Users/basket/workspace/go-claw/reference/goclaw/src/agent/worker.rs:82-95`; `517-524`; `/Users/basket/workspace/go-claw/reference/goclaw/src/orchestrator/api.rs:243-253`). | Mandate transaction ordering: event+journal commit before side-effect dispatch/ack; idempotency ledger required. | SIGKILL between effect dispatch and completion commit; verify dedupe prevents duplicate external writes. |
| R-03 | Client desynchronization under load/reconnect if replay/backpressure semantics are softened. | High | High | Rust SSE uses bounded broadcast and drops lagged events (`/Users/basket/workspace/go-claw/reference/goclaw/src/channels/web/sse.rs:25-27`; `53-54`). | Keep strict ACP replay-gap and deterministic close semantics; publish protocol state table. | Reconnect fuzz with random disconnects, slow consumer simulation, and cursor-age boundary tests. |
| R-04 | Credential leakage via URL/query token usage and startup logs. | Medium | High | Query token accepted in auth middleware (`/Users/basket/workspace/go-claw/reference/goclaw/src/channels/web/auth.rs:37-41`); tokenized URL logged (`/Users/basket/workspace/go-claw/reference/goclaw/src/main.rs:1000-1005`). | Add explicit ban on token-in-URL/log/error output; require header-only by default. | Secret-scanner over logs + browser-history-safe integration test for auth flows. |
| R-05 | Policy bypass from fragmented enforcement points. | Medium | Critical | Rust uses multiple separate checks (`/Users/basket/workspace/go-claw/reference/goclaw/src/channels/web/auth.rs:20-49`; `/Users/basket/workspace/go-claw/reference/goclaw/src/orchestrator/auth.rs:85-105`; `/Users/basket/workspace/go-claw/reference/goclaw/src/safety/policy.rs:93-121`). | Add mandatory PEP inventory and central PDP decision schema with contract tests per ingress path. | Negative auth matrix: every ACP/skill/legacy action tested for deny-by-default and audit event emission. |
| R-06 | WASM lifecycle instability (ABI/schema drift, non-deterministic activation). | Medium | High | Runtime metadata extraction uses TODO placeholders (`/Users/basket/workspace/go-claw/reference/goclaw/src/tools/wasm/runtime.rs:233-248`); activation is direct load (`/Users/basket/workspace/go-claw/reference/goclaw/src/extensions/manager.rs:929-943`). | Add ABI compatibility table, staged activation, rollback reason codes, and activation audit events. | Hot-reload chaos test: invalid ABI, invalid schema, runtime fault during activation; ensure atomic rollback. |
| R-07 | Supply-chain compromise or support blowup from online extension discovery in early releases. | Medium | High | Online discovery probes web + GitHub (`/Users/basket/workspace/go-claw/reference/goclaw/src/extensions/discovery.rs:32-47`; `124-133`). | Disable online discovery by default in v0.1; curated local manifests only; signed channel/tool path in later tier. | Red-team test with malicious discovered endpoint metadata; verify it cannot activate without trusted source path. |
| R-08 | Starvation/fairness regressions under contention if scheduler focuses only on max concurrency. | Medium | High | Rust enforces max jobs but no fairness aging semantics (`/Users/basket/workspace/go-claw/reference/goclaw/src/agent/scheduler.rs:87-93`). | Define fairness SLOs and required metrics in SPEC acceptance criteria. | Long-run mixed-load simulation with per-session latency distribution and starvation assertions. |
| R-09 | Sandbox boundary collapse if full-access mode is available without governance controls. | Low | Critical | `FullAccess` bypass exists in sandbox policy and manager (`/Users/basket/workspace/go-claw/reference/goclaw/src/sandbox/config.rs:68-71`; `/Users/basket/workspace/go-claw/reference/goclaw/src/sandbox/manager.rs:207-210`). | Add governance: explicit operator override, time-bounded enablement, mandatory audit event + alert. | Policy-evasion test suite: attempt prohibited actions with and without override; verify audit/alerts and expiry. |
| R-10 | Scope drift into a glue monolith, eroding reliability and maintainability. | High | High | Rust surface includes many subsystems/modules (`/Users/basket/workspace/go-claw/reference/goclaw/src/lib.rs:41-61`) and broad web control plane (`/Users/basket/workspace/go-claw/reference/goclaw/src/channels/web/server.rs:104-171`). | Enforce anti-bloat gates: dependency budget, endpoint budget, new-substrate prohibition, evidence-owner requirement. | Release gate script verifying budget deltas and failing builds when budgets or ADR rules are violated. |

## Immediate Monitoring Priorities
- Queue claim/reclaim correctness under crash and lock contention.
- Replay/backpressure behavior under slow-consumer conditions.
- Security hygiene checks for token leakage and policy bypass.
- Skill activation rollback and quarantine behavior under fault injection.

